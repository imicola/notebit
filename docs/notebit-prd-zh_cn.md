# 产品需求文档：Notebit

**版本**：1.0  
**日期**：2026-02-11  
**作者**：Sarah（产品负责人）  
**状态**：已批准  
**质量评分**：95/100  

---

## 1. 执行摘要

Notebit 是一款面向**个人知识管理（PKM）爱好者与研究人员**的**本地优先（Local-First）** Markdown 笔记应用。它弥合了无干扰写作与 AI 驱动知识管理之间的鸿沟。与通过自动补全等功能侵入写作流程的工具不同，Notebit 作为“静默策展人（Silent Curator）”，在用户完成写作后，利用本地运行或云端的大语言模型（LLM）与嵌入向量（embeddings）自动建立笔记间的关联、打标签并辅助知识回顾，全程保障用户隐私与数据主权。

---

## 2. 问题陈述

**现状**：  
- 传统笔记应用形成静态信息孤岛，笔记易在文件夹中遗失。  
- 现代 AI 编辑器通过“幽灵文本（Ghost Text）”和自动补全等功能干扰创作流程，打断心流。  
- 基于云端的解决方案以牺牲隐私为代价，难以满足研究人员及注重隐私用户的需求。

**解决方案**：  
- 构建“静心写作区（Sanctuary）”（纯净编辑器）与“静默策展人（Silent Curator）”（后台 AI）的双模块架构，AI 服务完全本地运行。  
- **核心理念**：“为人而写，由硅管理（Write for Humans, Manage by Silicon）”。

**商业价值**：  
- 通过“重新发现（Rediscovery）”价值提升用户留存率（笔记随时间推移愈发有价值）。  
- 强烈吸引注重隐私的细分用户群体（本地优先架构）。

---

## 3. 成功指标与关键绩效指标（KPI）

**核心 KPI**：  
1.  **知识检索成功率**：用户通过侧边栏/聊天功能在 30 秒内成功找到相关历史笔记的比例。  
2.  **系统延迟**：应用冷启动 < 2 秒；搜索/向量查询响应 < 200 毫秒。  
3.  **稳定性**：即使 AI 服务崩溃，100% 保障用户数据完整性。

**验证方式**：  
- 收集用户对“相关笔记”推荐准确性的反馈。  
- 建立自动化性能测试流水线。

---

## 4. 用户画像

### 主要用户：深度探索者（研究人员）  
- **角色**：学术或技术领域研究者。  
- **目标**：在不切换上下文的前提下，将当前写作与过往发现/文献引用建立关联。  
- **痛点**：难以追踪资料来源；对云端 AI 的隐私风险存有顾虑。  
- **行为特征**：撰写长文；重视准确性与参考文献。

### 次要用户：知识园丁（PKM 爱好者）  
- **角色**：知识工作者 / 终身学习者。  
- **目标**：培育“第二大脑”，定期回顾并精炼旧有想法。  
- **痛点**：“写完即忘”综合征；文件夹杂乱无章。  
- **行为特征**：依赖“每日摘要”功能发现知识关联；珍视意外发现（serendipity）。

---

## 5. 功能需求

### 模块 A：静心写作区（纯净编辑器）  
**优先级：P0**  
*   **用户故事**：作为一名用户，我希望拥有无干扰的输入体验，以便专注思考。  
*   **验收标准**：  
    *   支持标准 Markdown 语法高亮（兼容 GFM）。  
    *   实时本地文件系统保存。  
    *   **约束条件**：输入过程中**禁止**触发任何 AI 自动补全/幽灵文本功能。  
    *   支持所见即所得（WYSIWYG）与源码模式切换（P1）。

### 模块 B：静默策展人（后台智能）  
**优先级：P0（嵌入向量） / P1（侧边栏）**  
*   **用户故事**：作为一名用户，我希望笔记能自动建立关联，以便发现相关概念。  
*   **验收标准**：  
    *   **实时嵌入**：文件保存时（通过 `fsnotify` 监听），后台进程自动分块文本并生成向量存入 SQLite。  
    *   **语义侧边栏**：基于余弦相似度展示前 5 条相关笔记。  
    *   **优雅降级**：若 Ollama/嵌入服务离线，侧边栏仅显示“服务离线”图标，编辑器仍 100% 正常工作，**无阻断式错误弹窗**。

### 模块 C：知识回顾（RAG 与聊天）  
**优先级：P1**  
*   **用户故事**：作为一名研究人员，我希望通过对话方式与笔记交互，以综合信息。  
*   **验收标准**：  
    *   聊天界面与写作区域分离。  
    *   RAG（检索增强生成）管道在发送至 LLM 前先检索相关文本片段。  
    *   **引用要求**：所有回答**必须**附带来源文件链接（例如 `[[文件名]]`）。

### 模块 D：知识图谱  
**优先级：P2**  
*   **用户故事**：作为一名知识园丁，我希望可视化知识连接，以观察个人知识体系的“形态”。  
*   **验收标准**：  
    *   采用力导向图（force-directed graph）进行可视化。  
    *   基于语义相似度与显式 Wiki 链接自动建立节点关联。  
    *   交互式操作：点击节点可直接打开对应笔记。

---

## 6. 技术架构与约束

**技术栈**：  
*   **前端**：React + Tailwind CSS（Vite 构建）  
*   **后端**：Wails（Go）用于系统级绑定  
*   **数据库**：SQLite（存储元数据与向量嵌入）
*   **AI 服务**：Ollama（本地） / OpenAI 接口(P0)

**非功能性需求**：  
*   **性能**：向量搜索不得阻塞 UI 线程（使用 Go 协程处理）。  
*   **隐私**：所有嵌入向量默认存储于 `./data/db.sqlite`，**无外部网络请求**。  
*   **兼容性**：笔记以纯 `.md` 文件形式存储；卸载应用后，文件仍可被任意编辑器正常读取。

---

## 7. 路线图（分阶段交付）

### 迭代 1：骨架搭建（MVP）  
*   初始化 Wails + React 项目  
*   实现文件 I/O（打开文件夹、读写 `.md` 文件）  
*   基础 Markdown 编辑器界面

### 迭代 2：核心智能（AI 引擎）  
*   集成 SQLite + 向量扩展  
*   实现“保存 → 生成嵌入”流水线  
*   基础语义搜索功能（控制台输出）

### 迭代 3：用户体验优化  
*   实现语义侧边栏界面  
*   连接聊天界面与 Ollama  
*   完善优雅降级机制